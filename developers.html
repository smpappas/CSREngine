<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Client-Side Reliability Engine by smpappas</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Client-Side Reliability Engine</h1>
        <h2>Developers</h2>
        <a href="https://github.com/smpappas/CSREngine" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h2>Developers</h2>

<p>This page is meant for advanced users and developers. Information on hosting, writing new tests, and general class reference is provided.</p>

<h4>Files</h4>

<p>The directory structure of the CSREngine looks as follows</p>

<pre><code>csr-engine/
    css/
        csr-engine.css
        syntax/
            shCore.css
    js/
        csr-engine.js
        csr-test-cases.js
        beautify/
            beautify.js
        jslint/
            jslint.js
        syntax/
            shBrushCss.js
            shBrushJScript.js
            shBrushXml.js
            shCore.js
</code></pre>

<p><code>js/csr-test-cases.js</code> - Contains the implementation of all test cases, as well as a list of all test cases to be run.<br><code>js/csr-engine.css</code> - Contains all styling for the engine.<br><code>css/csr-engine.js</code> - Contains all classes and code relevant to the core functionality of the engine.<br><code>js/beautify/beautify.js</code> - Un-minifies scripts so that they can be analyzed.<br><code>js/jslint/jslint.js</code> - Contains the core functionality for JSLint by Douglas Crockford.<br><code>js/syntax/*</code> - Contains all scripts related to syntax highlighting.<br><code>css/syntax/shCore.css</code> - Contains styling for syntax highlighting.<br></p>

<h4>Hosting the Engine</h4>

<p>The engine is currently hosted at: <a href="http://www.steve-pappas.com/staticsmp/csr-engine/js/csr-engine.js">http://www.steve-pappas.com/staticsmp/csr-engine/js/csr-engine.js</a></p>

<p>To host the engine on a different server, each file needs to be uploaded to that server.  As explained above, the <code>&lt;script&gt;</code> tag in the Web page should link to the location of csr-engine.js.  In addition, csr-engine.js must be updated as described below.</p>

<p>The CSREngine class contains a member called locPrefix.  Update the following line to contain the paths to the root csr-engine/ folder.  This location is defined as the first member of the CSREngine class.</p>

<div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">locPrefix</span> <span class="o">=</span> <span class="s2">"path/to/csr-engine/"</span><span class="p">;</span>
</pre></div>

<h4>Managing and Writing User Defined Test Cases</h4>

<p>Each test case is designated a type, which determines which files the test applies to.</p>

<p>New test cases can be added into the file csr-test-cases.js. Existing test cases can be used as a guide. The steps to create a new test case are as follows</p>

<p>1)  Add a new entry to the populateTestCases function within the csrTestCases namespace.  The entry should look similar to below.  The first parameter specifies the namespace of the test case you are creating, always beginning with "csr" - look at examples for clarification.  The second parameter will specify the file that the test case resides in, but this should be left as null until this is implemented.  The last parameter specifies the type of test case and should be one of "html", "css", or "js".</p>

<div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">addTestCase</span><span class="p">(</span><span class="s2">"csrNamespaceOfTestCase"</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s2">"html"</span><span class="p">);</span>
</pre></div>

<p>2)  Create a namespace for the test case and an execute function.  The format should be similar to below.</p>

<div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">csrNamespaceOfTestCase</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">execute</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nb">document</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Test body goes here</span>
        <span class="p">}</span>

    <span class="p">};</span>
</pre></div>

<p>The execute function of your new test case will be called automatically.  There is no restriction to adding more helper functions within your new test namespace, and in fact this is encouraged for code clarity.  These functions can be called from execute, i.e. execute() can be thought of as a main() function, where code execution for your test case begins.</p>

<p>A complete example can be seen below. This code will test to see if a radix has been specified when using the ParseInt() function in JavaScript.</p>

<div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">csrNamespaceOfTestCase</span> <span class="o">=</span> <span class="p">{</span>

        <span class="nx">execute</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nb">document</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">matches</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">findFunction</span><span class="p">(</span><span class="s2">"parseInt"</span><span class="p">);</span>

            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">matches</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">printLines</span><span class="p">(</span><span class="s2">"No radix specified."</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">};</span>
</pre></div>

<h4>Searching and Scanning Document Code</h4>

<p>String parsing can be difficult, so some methods are provided to aid in searching and scanning the document. It is recommended to use these methods if possible in order to make the developer's life easier. Each method is described below along with sample usage.</p>

<p><code>Document.regex(pattern)</code> - Applies to HTML, CSS, JS
<br>      Runs a regular expression against source code and returns all matching locations and lines. Returns an array of Match objects.
<br>      You must use two forward slashes (\\) to escape characters.
<br>      Example usage:</p>

<pre><code>var pattern = "^\\$\\(function\\(\\)\\s*\\{" + util.anything() + "\\}\\);$";
var matches = document.regex(pattern);
</code></pre>

<p><code>Document.findFunction(f)</code> - Applies to JS
<br>      Finds instances of a function and returns locations and arguments. Returns an array of Match objects.
<br>      Example Usage:</p>

<pre><code>var matches = document.findFunction("myFunction");
</code></pre>

<p><code>Document.findTag(tag)</code> - Applies to HTML
<br>      Finds instances of html tags and returns attribute values. Returns an array of Match objects.
<br>      Example Usage:</p>

<pre><code>var matches = document.findTag("img");
</code></pre>

<p><code>Document.findSelector(s)</code> - Applies to CSS
<br>      Finds instances of class/identifier and returns properties and values. Returns an array of Match objects.
<br>      Example Usage:</p>

<pre><code>var matches = document.findSelector("#myId");
</code></pre>

<p><code>Document.findProperty(prop)</code> - Applies to CSS
<br>      Finds instances of property and returns and values. Returns an array of Match objects.
<br>      Example Usage:</p>

<pre><code>var matches = document.findProperty("font-family");
</code></pre>

<h4>The Match Class</h4>

<p>The Match class is used to return matches from regular expressions. Each of the above search methods runs a regular expression against the source code and returns an array of matches. Each of these matches contains various information that can be used and printed. The members of the Match class are</p>

<div class="highlight"><pre>    <span class="nx">doc</span>  <span class="c1">// Document where match was found</span>
    <span class="nx">code</span>  <span class="c1">// Matching code from the regular expression</span>
    <span class="nx">lineStart</span>  <span class="c1">// Line number that matching code starts on</span>
    <span class="nx">indexStart</span>  <span class="c1">// Index that matching code start at</span>
    <span class="nx">lineEnd</span>  <span class="c1">// Line number that matching code ends on</span>
    <span class="nx">lineCode</span>  <span class="c1">// Entire first line of code of the match</span>

    <span class="c1">// for findFunction()</span>
    <span class="nx">functionName</span>  <span class="c1">// Name of function</span>
    <span class="nx">args</span>  <span class="c1">// Array of function arguments</span>

    <span class="c1">// for findTag</span>
    <span class="nx">tag</span>  <span class="c1">// Tag being searched for</span>
    <span class="nx">attributes</span>  <span class="c1">// Array of tag attributes</span>
    <span class="nx">values</span>  <span class="c1">// Array of values for attributes</span>

    <span class="c1">// for findSelector() - values contains array of property values</span>
    <span class="nx">selector</span>  <span class="c1">// ID, class, or selector being searched for</span>
    <span class="nx">properties</span>  <span class="c1">// Array of properties found in the selector</span>

    <span class="c1">//for findProperty()</span>
    <span class="nx">property</span>  <span class="c1">// Property being searched for</span>
    <span class="nx">value</span>  <span class="c1">// Value for the property</span>
</pre></div>

<p>Depending on which search method is run, various members of the Match class will be populated. The developer can simply loop through an array of Match objects to access the information contained in each one. The Match class contains two print methods to easily print an issue to screen.</p>

<p><code>Match.printMatch(errorText)</code>
<br>      Automatically adds an error to the document and prints only code matching the regular expression. Takes in text of error message to print.</p>

<p><code>Match.printLines(errorText)</code>
<br>      Automatically adds an error to the document and prints all lines of code containing the regular expression. Takes in text of error message to print.</p>

<h4>Additional Helper Functions</h4>

<p>There are a number of additional helper functions available to help with implementing test cases. Please use existing examples as reference.</p>

<p><strong>Documents</strong></p>

<p><code>Document.getLines()</code>
<br>      Returns an array that consists of the document split into lines. This allows traversal of the document line by line using a <strong>for</strong> loop or similar.</p>

<p><code>Document.indexToLine(index)</code>
<br>      Takes an index number and converts it to a line number in source code.</p>

<p><code>Document.lineToCode(line)</code>
<br>      Takes a line number and returns the source code of the line.</p>

<p><code>Document.addError()</code>
<br>      Should be called when an error is found if not using the Match class. This is used to track the number of errors found in each document.</p>

<p><strong>Code Blocks</strong></p>

<p>A CodeBlock class has been implemented to make it easy to print formatted code to screen. Example usage is shown below, and member functions are described. This class only needs to be instantiated if NOT using one of the main search methods.</p>

<div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">lines</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getLines</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">line</span> <span class="o">=</span> <span class="nx">lines</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="c1">// Trim line to ensure trailing spaces and new lines are not included</span>
        <span class="kd">var</span> <span class="nx">cb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CodeBlock</span><span class="p">(</span><span class="nx">line</span><span class="p">.</span><span class="nx">trim</span><span class="p">(),</span> <span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="nx">cb</span><span class="p">.</span><span class="nx">print</span><span class="p">();</span>
    <span class="p">}</span>
</pre></div>

<p><code>CodeBlock(code, lineNumber)</code>
<br>      Initialize a new CodeBlock instance with code found at lineNumber.  Parameters code and lineNumber are optional, and CodeBlock will be initialized to be empty if not specified.</p>

<p><code>CodeBlock.add(code, lineNumber)</code>
<br>      Adds code found at lineNumber to current CodeBlock instance.  This can be used to create a single-line code block when the current instance is empty, or used to create multiline code blocks by calling this function on sequential lines of code.</p>

<p><code>CodeBlock.clear()</code>
<br>      Empties the current CodeBlock instance.  New code can be added to the existing code block through CodeBlock.add().</p>

<p><code>CodeBlock.print()</code>
<br>      Prints the current CodeBlock instance to screen.</p>

<p><strong>General Utility</strong></p>

<p><code>util.anything()</code>
<br>      For use in regular expression patterns, this returns a pattern that will match any characters including new lines in regular expression.
<br>      Example usage:</p>

<pre><code>var pattern = "^\\$\\(function\\(\\)\\s*\\{" + util.anything() + "\\}\\);$";
var matches = document.regex(pattern);
</code></pre>

<p><code>util.printString(s, classes)</code>
<br>      Print string s to screen.  This function should always be used when printing to the tool output. Parameter classes is optional and will add any specified CSS classes to the text output, e.g. to make text bold-italic specify "csr-bold csr-italic".</p>

<p><code>util.printError(lineNumber, e)</code>
<br>      Similar to util.printString(), prints error message e to screen. Parameter lineNumber specifies which line the error occurred on.</p>

<p><code>util.escapeHTML(code)</code>
<br>      When printing HTML code to screen, the code must be wrapped in this function in order to escape special characters. This prevents the browser from trying to execute or interpret code. This does not need to be used when printing Match objects directly.</p>

<hr><h2>Class Reference</h2>

<p>Class descriptions and primary member functions listed below.</p>

<h4>CSREngine Class</h4>

<p>Used to create an instance of the engine where code execution begins.</p>

<h4>DocAnalysis Class</h4>

<p>Used to run analysis on a particular document.</p>

<h4>TestCase Class</h4>

<p>Contains information about a test case including its type and where the implementation is located.</p>

<h4>Document Class</h4>

<p>Contains information about a document (file) including its location, type, and source code.</p>

<h4>Filters Class</h4>

<p>Used to create document filters to specify which documents should and should not be analyzed.</p>

<h4>Match Class</h4>

<p>Used to return and manipulate information obtained from running a regular expression on source code.</p>

<h4>CodeBlock Class</h4>

<p>Used to create a block or line of code to be printed to screen.</p>

<h4>util (Utility Namespace)</h4>

<p>Contains a number of utility and helper functions for use in implementing core functionality and test cases.</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/smpappas/CSREngine/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/smpappas/CSREngine/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/smpappas/CSREngine"></a> is maintained by <a href="https://github.com/smpappas">smpappas</a>.</p>

          <p>This page was generated by <a href="pages.github.com">GitHub Pages</a> using the Architect theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>